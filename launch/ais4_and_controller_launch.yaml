launch:
- arg: {name: use_sim_time, default: "true"}
- include:
    if: $(var use_sim_time)
    file: "$(find-pkg-share ais_launch)/launch/include/ais4_sim_launch.yaml"
    arg:
    - {name: world, value: /opt/ros/humble/share/turtlebot3_gazebo/worlds/turtlebot3_dqn_stage1.world}
- include:
    unless: $(var use_sim_time)
    file: "$(find-pkg-share ais_launch)/launch/include/ais4_robot_launch.yaml"

# - node:
#     pkg: "mouse_teleop"
#     exec: "mouse_teleop"
#     remap:
#     - {from: "mouse_vel", to: "cmd_vel_ref"}
#     param:
#     - {name: "scale", value: 0.5}

- node:
    unless: $(var use_sim_time)
    pkg: "joy"
    exec: "joy_node"

- node:
    unless: $(var use_sim_time)
    pkg: "ais_ui"
    exec: "ais_teleop_joy"
    remap:
    - {from: "cmd_vel/joy", to: "cmd_vel_ref"}
    param:
    - {name: "scale", value: 0.5}

- node:
    pkg: "collision_avoidance_2dl_cbf"
    exec: "collision_avoidance_2dl_cbf_node"
    remap:
    - {from: "/scan", to: "/scan"}
    - {from: "/cmd_vel_in", to: "/cmd_vel_ref"}
    - {from: "/cmd_vel_out", to: "/suitcase/cmd_vel"}
    # - {from: "/cmd_vel_out", to: "/cmd_vel/joy"}
    param:
    - {name: "base_frame", value: "base_link"}
    - {name: "scan_topic_names", value: ["scan", "back_scan"]}
    - {name: "gamma", value: 0.5}
    - {name: "epsilon", value: 0.0001}
    - {name: "is_debug", value: true}

- node:
    pkg: "collision_avoidance_2dl_cbf"
    exec: "publish_collision_polygon_node"
    param:
    - {name: "base_frame_id", value: "base_link"}
    - {name: "plot_count", value: 100}
    # - {name: "robot", value: {x: 0.06, y: 0.0, r: 0.1812}}
    - {name: "robot.x", value: -0.12}
    - {name: "robot.y", value: 0.0}
    - {name: "robot.r", value: 0.35}
    # - {name: "user",  value: {x: -0.06, y: -0.17, r: 0.3}}
    - {name: "user.x", value: -0.2}
    - {name: "user.y", value: -0.3}
    - {name: "user.r", value: 0.4}

# - include:
#     file: "$(find-pkg-share nav2_bringup)/launch/localization_launch.py"
#     arg:
#     - {name: use_sim_time, value: $(var use_sim_time)}
#     - {name: params_file, value: $(find-pkg-share suitcase_nav)/param/suitcase_nav2.yaml}
#     - {name: map, value: $(find-pkg-share sc_map_server)/map/giken6F_real/giken6F_real_localization.yaml}
#     # - {name: map, value: $(find-pkg-share sc_map_server)/map/tb3_dqn_stage1_localization/tb3_dqn_stage1_localization.yaml}

# - include:
#     file: "$(find-pkg-share nav2_bringup)/launch/bringup_launch.py"
#     arg:
#     - {name: use_sim_time, value: $(var use_sim_time)}
#     - {name: params_file, value: $(find-pkg-share suitcase_nav)/param/suitcase_nav2.yaml}
#     # - {name: map, value: $(find-pkg-share sc_map_server)/map/tb3_dqn_stage1_localization/tb3_dqn_stage1_localization.yaml}
#     - {name: map, value: $(find-pkg-share sc_map_server)/map/giken6F_real/giken6F_real_localization.yaml}

# - node:
#     pkg: tf2_ros
#     exec: static_transform_publisher
#     args: "0.0 0.0 -0.0 -0.0 0.0 0.0 odom map"
#     param:
#     - {name: "use_sim_time", value: $(var use_sim_time)}

# - node:
#     pkg: rviz2
#     exec: rviz2
#     args: "-d $(find-pkg-share collision_avoidance_2dl_cbf)/config/ais4.rviz"
#     param:
#     - {name: "use_sim_time", value: $(var use_sim_time)}
